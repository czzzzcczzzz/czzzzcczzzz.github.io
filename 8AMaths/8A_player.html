<!DOCTYPE html>
<html lang="zh-Hant">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>课程播放 - 八年级秋季数学自招班</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;500;700&display=swap" rel="stylesheet">
    <link href="https://unpkg.com/ionicons@5.5.2/dist/css/ionicons.min.css" rel="stylesheet">
    
    <style>
        /* === 保持橙色系 UI 风格 === */
        :root {
            --platinum: #E5E4E2;
            --silver: #C0C0C0;
            --metal-accent: #6C757D;
            --obsidian: #0A0A0A;
            --orange: #FF8C42;
            --orange-light: #FFB88C;
            --gradient-angle: 152deg;
        }

        * { margin: 0; padding: 0; box-sizing: border-box; font-family: "Microsoft YaHei", sans-serif; }

        /* 禁止选中文字，增加复制难度 */
        body {
            background: linear-gradient(var(--gradient-angle), var(--platinum) 0%, rgba(229,228,226,0.95) 50%, rgba(192,192,192,0.9) 100%);
            min-height: 100vh;
            padding-top: 80px;
            display: flex;
            flex-direction: column;
            user-select: none; /* 禁止选中 */
            -webkit-user-select: none;
        }

        /* 导航栏 */
        .nav-bar {
            background: rgba(255, 255, 255, 0.88);
            padding: 1.2rem 5%;
            backdrop-filter: saturate(180%) blur(20px);
            position: fixed; width: 100%; top: 0; z-index: 1000;
            box-shadow: 0 4px 12px rgba(0,0,0,0.06);
        }
        .nav-content { max-width: 1200px; margin: 0 auto; display: flex; justify-content: space-between; align-items: center; }
        .logo { font-size: 1.8rem; color: var(--obsidian); font-weight: 700; }
        .logo span { color: var(--orange); }
        .nav-links { display: flex; gap: 2rem; align-items: center; }
        .nav-link { color: var(--metal-accent); text-decoration: none; position: relative; padding: 0.5rem 0; transition: 0.3s; }
        .nav-link:hover { color: var(--orange); }
        
        /* 主体内容 */
        main { flex-grow: 1; max-width: 1000px; margin: 0 auto; padding: 2rem 5%; width: 100%; }

        .lesson-header { text-align: center; margin-bottom: 2rem; border-bottom: 2px solid var(--silver); padding-bottom: 1rem; }
        .lesson-title { font-size: 2rem; color: var(--obsidian); margin-bottom: 0.5rem; font-weight: 700; }
        .lesson-subtitle { font-size: 1rem; color: var(--metal-accent); }

        /* 按钮组 */
        .lesson-navigation { display: flex; justify-content: center; gap: 1rem; margin-bottom: 2rem; flex-wrap: wrap; }
        .nav-button {
            padding: 0.7rem 1.5rem; border-radius: 6px; text-decoration: none; font-size: 1rem;
            font-weight: 500; transition: all 0.3s ease; display: flex; align-items: center; gap: 0.5rem; cursor: pointer;
        }
        .nav-button.active { background: var(--orange); color: white; border: 1px solid var(--orange); box-shadow: 0 4px 8px rgba(255, 140, 66, 0.4); }
        .nav-button.inactive { background: var(--platinum); color: var(--metal-accent); border: 1px solid var(--silver); }
        .nav-button.inactive:hover { background: var(--silver); color: var(--obsidian); }

        /* 视频容器 */
        .video-container {
            position: relative; width: 100%; padding-bottom: 56.25%; background-color: var(--obsidian);
            border-radius: 8px; overflow: hidden; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3); margin-bottom: 2rem;
        }
        video { position: absolute; top: 0; left: 0; width: 100%; height: 100%; outline: none; }

        .video-info { display: flex; justify-content: space-around; padding: 1rem 0; border-top: 1px dashed var(--silver); }
        .info-box { text-align: center; }
        .info-value { font-size: 1.5rem; font-weight: 700; color: var(--orange); }
        .info-label { font-size: 0.9rem; color: var(--metal-accent); }

        footer { background: rgba(255, 255, 255, 0.9); padding: 3rem 5%; text-align: center; margin-top: auto; }

        @media (max-width: 768px) {
            .nav-links { display: none; } /* 移动端简化 */
            .lesson-navigation { flex-direction: column; }
            .nav-button { width: 100%; justify-content: center; }
        }
    </style>
</head>
<body oncontextmenu="return false;">
    <nav class="nav-bar">
        <div class="nav-content">
            <div class="logo">橙子<span>粥粥粥</span></div>
            <div class="nav-links">
                <a href="8Aindex.html" class="nav-link">返回课程列表</a>
                <a href="#" class="nav-link" onclick="handleLogout()">退出登录</a>
            </div>
        </div>
    </nav>

    <main>
        <header class="lesson-header">
            <h1 class="lesson-title" id="lesson-title">加载中...</h1>
            <div class="lesson-subtitle">八年级秋季数学自招班 - <span id="lesson-number"></span></div>
        </header>
        
        <div class="content">
            <div class="lesson-navigation">
                <button onclick="switchPart('p1')" id="btn-p1" class="nav-button active">
                    <ion-icon name="videocam-outline"></ion-icon> 视频 P1
                </button>
                <button onclick="switchPart('p2')" id="btn-p2" class="nav-button inactive">
                    <ion-icon name="videocam-outline"></ion-icon> 视频 P2
                </button>
                <a id="btn-files" href="#" target="_blank" class="nav-button inactive">
                    <ion-icon name="document-text-outline"></ion-icon> 课程资料
                </a>
            </div>

            <div class="video-container">
                <video id="video-player" controls controlsList="nodownload" disablePictureInPicture>
                    <source id="video-source" src="" type="video/mp4">
                    您的浏览器不支持 HTML5 视频。
                </video>
            </div>

            <div class="video-info">
                <div class="info-box">
                    <div class="info-value" id="current-part-display">P1</div>
                    <div class="info-label">当前分集</div>
                </div>
                <div class="info-box">
                    <div class="info-value">高清</div>
                    <div class="info-label">画质</div>
                </div>
                <div class="info-box">
                    <div class="info-value" id="teacher-name">高扶林</div>
                    <div class="info-label">授课老师</div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <p>© 2023 橙子粥粥粥的个人博客. 保留所有权利.</p>
    </footer>

    <script type="module" src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@5.5.2/dist/ionicons/ionicons.js"></script>

    <script>
        // ==========================================
        // 1. 课程数据配置 (核心部分)
        // ==========================================
        const allLessons = [
            {
                id: 1,
                title: "第一讲：一次函数与全等存在性问题",
                p1_url: "", // 请在此处填入P1视频链接
                p2_url: "", // 请在此处填入P2视频链接
                files_url: "/8AMaths/files.html"
            },
            {
                id: 2,
                title: "第二讲：一次函数与几何模型",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 3,
                title: "第三讲：几何变换之旋转一",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/1e7819215145403699412026159/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/956a25735145403699570855666/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 4,
                title: "第四讲：几何变换之旋转二",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/2024157f5145403700329839362/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/0adfdf9c5145403700149618760/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 5,
                title: "第五讲：几何变换之平移",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/9f45aca05145403701467119557/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/f636c8f05145403701315261164/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 6,
                title: "第六讲：几何变换之对称一",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/9f72bba15145403702514645749/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/d19f4e765145403702525339034/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 7,
                title: "第七讲：几何变换之对称二",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/d169ef5e5145403703369307391/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/537733d55145403703245494013/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 8,
                title: "第八讲：前沿命题剖析与能力培养（期中复习）",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/80161afc5145403704195460625/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/6506e7b85145403704204976024/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 9,
                title: "第九讲：折叠问题",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/caefc4a85145403705046955758/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/a89412b05145403705015216631/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 10,
                title: "第十讲：绝配角与角格点问题",
                p1_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/29f578ae5145403705801112631/f0.mp4",
                p2_url: "https://playback.eeo.cn/794b4a11vodbj1252412222/6d9857bd5145403705860423618/f0.mp4",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 11,
                title: "第十一讲：成比例线段及其模型",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 12,
                title: "第十二讲：相似图形的性质及判定",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 13,
                title: "第十三讲：相似三角形的基本模型（一）",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 14,
                title: "第十四讲：相似三角形的基本模型（二）",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 15,
                title: "第十五讲：相似三角形动态问题综合",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 16,
                title: "第十六讲：梅涅劳斯定理与塞瓦定理",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            },
            {
                id: 17,
                title: "第十七讲：前沿命题剖析与能力培养（期末复习）",
                p1_url: "",
                p2_url: "",
                files_url: "/8AMaths/files.html"
            }
        ];

        // ==========================================
        // 2. 页面逻辑
        // ==========================================
        
        // 获取 URL 参数
        const urlParams = new URLSearchParams(window.location.search);
        const lessonId = parseInt(urlParams.get('id')) || 1; // 默认第一讲
        const partParam = urlParams.get('part') || 'p1'; // 默认 P1

        // 查找当前课程数据
        const currentLesson = allLessons.find(l => l.id === lessonId);

        // 初始化页面
        document.addEventListener('DOMContentLoaded', function() {
            checkLogin();

            if (!currentLesson) {
                alert("未找到该课程！");
                window.location.href = '8Aindex.html';
                return;
            }

            // 渲染基础信息
            document.getElementById('lesson-title').textContent = currentLesson.title;
            document.getElementById('lesson-number').textContent = `第 ${lessonId} 讲`;
            document.getElementById('btn-files').href = currentLesson.files_url;

            // 初始化播放部分
            switchPart(partParam);
            
            // --- 增强的防下载逻辑 ---
            setupProtection();
        });

        // 切换 P1 / P2 逻辑
        function switchPart(part) {
            const videoPlayer = document.getElementById('video-player');
            const btnP1 = document.getElementById('btn-p1');
            const btnP2 = document.getElementById('btn-p2');
            const partDisplay = document.getElementById('current-part-display');

            let videoUrl = "";

            // 更新按钮样式
            if (part === 'p1') {
                videoUrl = currentLesson.p1_url;
                btnP1.classList.add('active'); btnP1.classList.remove('inactive');
                btnP2.classList.add('inactive'); btnP2.classList.remove('active');
                partDisplay.textContent = "P1";
            } else {
                videoUrl = currentLesson.p2_url;
                btnP2.classList.add('active'); btnP2.classList.remove('inactive');
                btnP1.classList.add('inactive'); btnP1.classList.remove('active');
                partDisplay.textContent = "P2";
            }

            // 切换视频源
            videoPlayer.src = videoUrl;
            videoPlayer.load(); // 重新加载视频
            
            // 更新 URL (不刷新页面)
            const newUrl = `${window.location.pathname}?id=${lessonId}&part=${part}`;
            window.history.pushState({path: newUrl}, '', newUrl);
        }

        // === 防下载保护逻辑 ===
        function setupProtection() {
            const videoElement = document.getElementById('video-player');

            // 1. 禁止视频区域右键
            videoElement.addEventListener('contextmenu', function(e) {
                e.preventDefault();
                return false;
            });

            // 2. 禁止键盘快捷键 (Ctrl+S, Ctrl+U, F12)
            document.addEventListener('keydown', function(e) {
                // 禁止 F12
                if (e.key === 'F12') { e.preventDefault(); return false; }
                // 禁止 Ctrl+S (保存)
                if ((e.ctrlKey || e.metaKey) && (e.key === 's' || e.key === 'S')) {
                    e.preventDefault();
                    alert('此页面内容受保护，无法保存。');
                    return false;
                }
                // 禁止 Ctrl+U (查看源码 - 虽然防不住高手，但能防普通人)
                if ((e.ctrlKey || e.metaKey) && (e.key === 'u' || e.key === 'U')) {
                    e.preventDefault();
                    return false;
                }
            });
        }

        // 登录检查
        function checkLogin() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            if (isLoggedIn !== 'true') {
                alert('请先登录！');
                window.location.href = 'https://czzzzcczzzz.github.io/login.html';
            }
        }

        // 登出
        function handleLogout() {
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'https://czzzzcczzzz.github.io/login.html';
        }
    </script>
</body>
</html>
